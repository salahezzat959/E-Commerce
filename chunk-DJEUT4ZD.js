import{a as P}from"./chunk-N37VDLRC.js";import{a as T,b as h,c as I,d as V,h as M,i as N,j as q,k as G,m as D}from"./chunk-6Y6WHHO3.js";import{l as H}from"./chunk-TDOEA3BW.js";import"./chunk-P4V3XCEK.js";import{f as L,h as O}from"./chunk-3ICPM7S4.js";import"./chunk-HZLQKCUW.js";import{$a as E,Bb as w,Cb as x,Kb as a,Ra as r,Rb as k,Sb as v,Tb as _,Y as p,ea as y,eb as d,fa as S,ga as g,ha as b,kb as C,ob as s,sb as e,tb as t,ub as m,xb as F}from"./chunk-SB5BPJ2M.js";import"./chunk-EQDQRRRY.js";function A(n,i){n&1&&(e(0,"li"),a(1,"details is required"),t())}function B(n,i){if(n&1&&(e(0,"div",6),g(),e(1,"svg",12),m(2,"path",13),t(),b(),e(3,"span",14),a(4,"Danger"),t(),e(5,"div")(6,"ul",15),d(7,A,2,0,"li"),t()()()),n&2){x();let o=_(5);r(7),s(o!=null&&o.getError("required")?7:-1)}}function Z(n,i){n&1&&(e(0,"li"),a(1,"Phone is required"),t())}function j(n,i){n&1&&(e(0,"li"),a(1,"Enter valid phone"),t())}function z(n,i){if(n&1&&(e(0,"div",6),g(),e(1,"svg",12),m(2,"path",13),t(),b(),e(3,"span",14),a(4,"Danger"),t(),e(5,"div")(6,"ul",15),d(7,Z,2,0,"li")(8,j,2,0,"li"),t()()()),n&2){x();let o=_(11);r(7),s(o!=null&&o.getError("required")?7:o!=null&&o.getError("pattern")?8:-1)}}function $(n,i){n&1&&(e(0,"li"),a(1,"City is required"),t())}function J(n,i){if(n&1&&(e(0,"div",6),g(),e(1,"svg",12),m(2,"path",13),t(),b(),e(3,"span",14),a(4,"Danger"),t(),e(5,"div")(6,"ul",15),d(7,$,2,0,"li"),t()()()),n&2){x();let o=_(17);r(7),s(o!=null&&o.getError("required")?7:-1)}}function K(n,i){n&1&&(e(0,"span"),m(1,"i",16),t())}function Q(n,i){n&1&&(e(0,"span"),m(1,"i",16),t())}var R=class n{formBuilder=p(G);activatedRoute=p(L);ordersService=p(P);router=p(O);toastrService=p(H);cartId="";checkOutForm;isLoading=!1;ngOnInit(){this.initForm(),this.getCartId()}initForm(){this.checkOutForm=this.formBuilder.group({details:[null,[h.required]],phone:[null,[h.required,h.pattern(/^01[0125][0-9]{8}$/)]],city:[null,[h.required]]})}getCartId(){this.activatedRoute.paramMap.subscribe({next:i=>{this.cartId=i.get("id")}})}submitFormOnline(){this.isLoading=!0,this.cartId&&this.ordersService.checkoutPayment(this.cartId,this.checkOutForm.value).subscribe({next:i=>{console.log(i),i.status=="success"&&open(i.session.url,"_self"),this.isLoading=!1},error:i=>{console.log(i)}})}submitFormCash(){this.isLoading=!0,this.cartId&&this.ordersService.cashOrder(this.cartId,this.checkOutForm.value).subscribe({next:i=>{console.log(i),i.status=="success"&&(this.toastrService.info(i.status,"FreshCart"),this.router.navigate(["/allorders"])),this.isLoading=!1},error:i=>{console.log(i)}})}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=E({type:n,selectors:[["app-checkout"]],decls:29,vars:11,consts:[[1,"mx-auto","w-[60%]","bg-gray-50","rounded","border-1","shadow","p-5"],[1,"capitalize","text-2xl","text-green-600","font-bold","pb-3","text-center"],[3,"formGroup"],[1,"mb-4"],["for","details",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","details","id","details",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["role","alert",1,"flex","p-4","mb-4","text-sm","text-red-800","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400"],["for","phone",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","phone","type","tel","id","phone",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["for","password",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","city","type","text","id","password",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],[1,"btn-main","w-full","sm:w-auto","px-6","sm:px-12","py-2","sm:py-3","text-sm","sm:text-base","font-semibold;",3,"click","disabled"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"shrink-0","inline","w-4","h-4","me-3","mt-[2px]"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"],[1,"sr-only"],[1,"mt-1.5","list-disc","list-inside"],[1,"fas","fa-spin","fa-spinner"]],template:function(o,l){if(o&1){let c=F();e(0,"section",0)(1,"h1",1),a(2,"Check Out"),t(),e(3,"form",2)(4,"div",3),k(5),e(6,"label",4),a(7,"details:"),t(),m(8,"textarea",5),d(9,B,8,1,"div",6),t(),e(10,"div",3),k(11),e(12,"label",7),a(13,"phone:"),t(),m(14,"input",8),d(15,z,9,1,"div",6),t(),e(16,"div",3),k(17),e(18,"label",9),a(19,"city:"),t(),m(20,"input",10),d(21,J,8,1,"div",6),t(),e(22,"button",11),w("click",function(){return y(c),S(l.submitFormOnline())}),a(23,"Online Payment "),d(24,K,2,0,"span"),t(),a(25," \xA0 "),e(26,"button",11),w("click",function(){return y(c),S(l.submitFormCash())}),a(27," Cash Payment "),d(28,Q,2,0,"span"),t()()()}if(o&2){r(3),C("formGroup",l.checkOutForm),r(2);let c=v(l.checkOutForm.get("details"));r(4),s(c!=null&&c.errors&&(c!=null&&c.touched)?9:-1),r(2);let u=v(l.checkOutForm.get("phone"));r(4),s(u!=null&&u.errors&&(u!=null&&u.touched)?15:-1),r(2);let f=v(l.checkOutForm.get("city"));r(4),s(f!=null&&f.errors&&(f!=null&&f.touched)?21:-1),r(),C("disabled",l.isLoading),r(2),s(l.isLoading?24:-1),r(2),C("disabled",l.isLoading),r(2),s(l.isLoading?28:-1)}},dependencies:[D,M,T,I,V,N,q],encapsulation:2})};export{R as CheckoutComponent};
